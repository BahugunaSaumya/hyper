<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Thank you!</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
  <h1 class="text-3xl font-bold mb-4">Thank you ðŸŽ‰</h1>
  <div id="out" class="whitespace-pre rounded bg-gray-100 p-4"></div>

  <script type="module" src="./auth.js"></script>
  <script>
    (async () => {
      const params = new URLSearchParams(location.search);
      const id = params.get('order') || localStorage.getItem('lastOrderId');
      const out = document.getElementById('out');
      if (!id) { out.textContent = 'No order id'; return; }

      await window.firebaseReady;
      const { doc, getDoc } = window.fs;
      const { db } = window.firebaseStuff;

      const snap = await getDoc(doc(db, 'orders', id));
      if (!snap.exists()) { out.textContent = 'Order not found'; return; }

      const data = snap.data();
      out.textContent =
        `Order No: ${data.orderNo}\n` +
        `Status:   ${data.status}\n` +
        `Total:    â‚¹ ${data.totals?.total}\n\n` +
        `Items:\n` + (data.items||[]).map(i => `â€¢ ${i.title} (${i.size}) Ã—${i.qty} â€” â‚¹${i.unitPrice}`).join('\n');
    })();
  </script>
</body>
</html>
